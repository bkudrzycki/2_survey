YS10_27 == 1 ~ 0))
levels(df$fiveryrs) <- c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other")
df %>% tbl_summary(by = "status", include = "fiveyrs")
df <- ys_panel %>% filter(status %in% c(2,3,4)) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
levels(df$fiveyrs) <- c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other")
df %>% tbl_summary(by = "status", include = "fiveyrs")
df$status
ys_panel <- read_sav("data/youth_survey_reshaped.sav", user_na = TRUE)
# filter by age and code status
ys_panel <- ys_panel %>%
mutate(status = ifelse(YS4_1 == 1 | (YS1_2 == 1 & wave == 0), 5,
ifelse(YS8_4 %in% c(1,2,3,5,6,8), 4,
ifelse(YS8_4 == 4, 3, NA)))) %>%
mutate(status = ifelse(is.na(status) & YS7_1 == 1, 1, status)) %>%
mutate(status = ifelse(is.na(status) & F3U2_0a == 1 & YS8_4 %in% c(1,2,3,5,6,8), 4, status)) %>%
mutate(status = ifelse(is.na(status) & YE3_5 == 1 & YS8_4 %in% c(1,2,3,5,6,8), 4, status)) %>%
mutate(status = ifelse(is.na(status) & YE3_5 == 1 & YS8_4 == 4, 3, status)) %>%
mutate(status = ifelse(is.na(status), 2, status2))
ys_panel$status <- factor(ys_panel$status, levels=c("In School", "NEET", "Self-Employed", "Employed", "Apprentice"))
# filter by age and code status
ys_panel <- ys_panel %>%
mutate(status = ifelse(YS4_1 == 1 | (YS1_2 == 1 & wave == 0), 5,
ifelse(YS8_4 %in% c(1,2,3,5,6,8), 4,
ifelse(YS8_4 == 4, 3, NA)))) %>%
mutate(status = ifelse(is.na(status) & YS7_1 == 1, 1, status)) %>%
mutate(status = ifelse(is.na(status) & F3U2_0a == 1 & YS8_4 %in% c(1,2,3,5,6,8), 4, status)) %>%
mutate(status = ifelse(is.na(status) & YE3_5 == 1 & YS8_4 %in% c(1,2,3,5,6,8), 4, status)) %>%
mutate(status = ifelse(is.na(status) & YE3_5 == 1 & YS8_4 == 4, 3, status)) %>%
mutate(status = ifelse(is.na(status), 2, status))
ys_panel$status <- factor(ys_panel$status, levels=c("In School", "NEET", "Self-Employed", "Employed", "Apprentice"))
table(ys_panel$status)
ys_panel <- ys_panel %>%
mutate(status = ifelse(YS4_1 == 1 | (YS1_2 == 1 & wave == 0), 5,
ifelse(YS8_4 %in% c(1,2,3,5,6,8), 4,
ifelse(YS8_4 == 4, 3, NA)))) %>%
mutate(status = ifelse(is.na(status) & YS7_1 == 1, 1, status)) %>%
mutate(status = ifelse(is.na(status) & F3U2_0a == 1 & YS8_4 %in% c(1,2,3,5,6,8), 4, status)) %>%
mutate(status = ifelse(is.na(status) & YE3_5 == 1 & YS8_4 %in% c(1,2,3,5,6,8), 4, status)) %>%
mutate(status = ifelse(is.na(status) & YE3_5 == 1 & YS8_4 == 4, 3, status)) %>%
mutate(status = ifelse(is.na(status), 2, status))
ys_panel$status
ys_panel$status <- factor(ys_panel$status, levels=c("In School", "NEET", "Self-Employed", "Employed", "Apprentice"))
ys_panel$status
df <- ys_panel %>% filter(status %in% c(2,3,4)) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
levels(df$fiveyrs) <- c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other")
df$fiveyrs
df <- ys_panel %>% filter(status %in% c(2,3,4)) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
labels(df$fiveyrs) <- c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other")
df$fiveyrs <- factor(df$fiveyrs, levels = c(0:5), labels = c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other"))
df <- ys_panel %>% filter(status %in% c(2,3,4)) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df$fiveyrs <- factor(df$fiveyrs, levels = c(0:5), labels = c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other"))
df$fiveyrs
df <- ys_panel %>% filter(status %in% c(2,3,4)) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
ys_panel$status <- factor(ys_panel$status, levels = c(1:5), labels=c("In School", "NEET", "Self-Employed", "Employed", "Apprentice"))
ys_panel <- read_sav("data/youth_survey_reshaped.sav", user_na = TRUE)
# filter by age and code status
ys_panel <- ys_panel %>%
mutate(status = ifelse(YS4_1 == 1 | (YS1_2 == 1 & wave == 0), 5,
ifelse(YS8_4 %in% c(1,2,3,5,6,8), 4,
ifelse(YS8_4 == 4, 3, NA)))) %>%
mutate(status = ifelse(is.na(status) & YS7_1 == 1, 1, status)) %>%
mutate(status = ifelse(is.na(status) & F3U2_0a == 1 & YS8_4 %in% c(1,2,3,5,6,8), 4, status)) %>%
mutate(status = ifelse(is.na(status) & YE3_5 == 1 & YS8_4 %in% c(1,2,3,5,6,8), 4, status)) %>%
mutate(status = ifelse(is.na(status) & YE3_5 == 1 & YS8_4 == 4, 3, status)) %>%
mutate(status = ifelse(is.na(status), 2, status))
ys_panel$status <- factor(ys_panel$status, levels = c(1:5), labels=c("In School", "NEET", "Self-Employed", "Employed", "Apprentice"))
ys_panel$labels
ys_panel$status
table(ys_panel$status)
source("~/polybox/Youth Employment/1a Youth Survey/Markdown/code/prep/survey_cleaning.R", echo=TRUE)
df <- ys_panel %>% filter(status %in% c(2,3,4)) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df$fiveyrs <- factor(df$fiveyrs, levels = c(0:5), labels = c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other"))
df %>% tbl_summary(by = "status", include = "fiveyrs")
ys_panel <- read_sav("data/youth_survey_reshaped.sav", user_na = TRUE)
# filter by age and code status
ys_panel <- ys_panel %>%
mutate(status = ifelse(YS4_1 == 1 | (YS1_2 == 1 & wave == 0), 5,
ifelse(YS8_4 %in% c(1,2,3,5,6,8), 4,
ifelse(YS8_4 == 4, 3, NA)))) %>%
mutate(status = ifelse(is.na(status) & YS7_1 == 1, 1, status)) %>%
mutate(status = ifelse(is.na(status) & F3U2_0a == 1 & YS8_4 %in% c(1,2,3,5,6,8), 4, status)) %>%
mutate(status = ifelse(is.na(status) & YE3_5 == 1 & YS8_4 %in% c(1,2,3,5,6,8), 4, status)) %>%
mutate(status = ifelse(is.na(status) & YE3_5 == 1 & YS8_4 == 4, 3, status)) %>%
mutate(status = ifelse(is.na(status), 2, status))
ys_panel$status
ys_panel$status %>% as.factor
ys_panel$status %>% as.factor()
df <- ys_panel %>% filter(as.factor(status) %in% c(2,3,4)) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df$fiveyrs <- factor(df$fiveyrs, levels = c(0:5), labels = c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other"))
df %>% tbl_summary(by = "status", include = "fiveyrs")
df %>% tbl_summary(by = "status", include = "fiveyrs", missing = "no")
df <- ys_panel %>% zap_labels() %>% filter(as.factor(status) %in% c(2,3,4)) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df$fiveyrs <- factor(df$fiveyrs, levels = c(0:5), labels = c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other"))
df %>% tbl_summary(by = "status", include = "fiveyrs", missing = "no") %>% rename("Where do you see yourself in five years" = fiveyrs)
df <- df %>% rename("Where do you see yourself in five years" = fiveyrs)
df %>% tbl_summary(by = "status", include = "fiveyrs", missing = "no") %>%
gen fiveyrs = 0 if YS10_27 == 1
df %>% tbl_summary(by = "status", include = "fiveyrs", missing = "no")
df$fiveyrs <- factor(df$fiveyrs, levels = c(0:5), labels = c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other"))
df <- ys_panel %>% zap_labels() %>% filter(as.factor(status) %in% c(2,3,4)) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df$fiveyrs <- factor(df$fiveyrs, levels = c(0:5), labels = c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other"))
df %>% tbl_summary(by = "status", include = "fiveyrs", missing = "no", label = fiveyrs ~ "Where do you see yourself in five years?")
df %>% tbl_summary(by = "status", include = "fiveyrs", missing = "no", label = fiveyrs ~ "Where do you see yourself in five years?", modify_table_header(column = ""))
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?",
modify_header(label = ""),
modify_footnote(update = everything() ~ NA))
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?",
modify_header(label = " "),
modify_footnote(update = everything() ~ NA))
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?") %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA))
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?") %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA)
df <- ys_panel %>% zap_labels() %>% filter(as.factor(status) %in% c(2:4)) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df$status <- factor(df$status, levels = c(2:4), labels=c("NEET", "Self-Employed", "Employed"))
df$fiveyrs <- factor(df$fiveyrs, levels = c(0:5), labels = c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other"))
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?") %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA)
detach(package:gtsummary, unload = TRUE)
install.packages("gtsummary")
df <- ys_panel %>% zap_labels() %>% filter(as.factor(status) %in% c(2:4)) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df$status <- factor(df$status, levels = c(2:4), labels=c("NEET", "Self-Employed", "Employed"))
df$fiveyrs <- factor(df$fiveyrs, levels = c(0:5), labels = c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other"))
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?") %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA)
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?") %>%
modify_header(label = " ")
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?")
library(gtsummary)
df <- ys_panel %>% zap_labels() %>% filter(as.factor(status) %in% c(2:4)) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df$status <- factor(df$status, levels = c(2:4), labels=c("NEET", "Self-Employed", "Employed"))
df$fiveyrs <- factor(df$fiveyrs, levels = c(0:5), labels = c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other"))
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?") %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA)
statistic = list(all_categorical() ~ "{p}%") %>%
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?",
statistic = list(all_categorical() ~ "{p}%")) %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA)
df <- ys_panel %>% zap_labels() %>% filter(as.factor(status) %in% c(2:4)) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df$status <- factor(df$status, levels = c(2:4), labels=c("NEET", "Self-Employed", "Employed"))
df$fiveyrs <- factor(df$fiveyrs, levels = c(0:5), labels = c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other"))
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?",
statistic = list(all_categorical() ~ "{p}%")) %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA)
df <- ys_panel %>% zap_labels() %>% filter(as.factor(status) %in% c(2:4), wave == 0) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df$status <- factor(df$status, levels = c(2:4), labels=c("NEET", "Self-Employed", "Employed"))
df$fiveyrs <- factor(df$fiveyrs, levels = c(0:5), labels = c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other"))
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?",
statistic = list(all_categorical() ~ "{p}%")) %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA)
packages <- c("haven", "tinytex", "survey", "bookdown", "gtsummary", "janitor", "labelled", "kableExtra", "stargazer", "tidyverse")
options(repos = c(CRAN = "http://cran.rstudio.com"))
# install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
install.packages(packages[!installed_packages], silent = TRUE)
}
# load packages
invisible(lapply(packages, library, character.only = TRUE))
rm(packages, installed_packages)
# load data
# source("../code/master.R") # to rerun all code periodically
load("../data/ys_panel.rda")
load("../data/ys_panel_labels.rda")
ys_baseline <- ys_panel %>% filter(wave == 0)
# load functions
source("../functions/add_by_n.R")
source("../functions/paste_matrix.R")
# load code chunks
knitr::read_chunk('../code/survey_tbls_body.R')
knitr::read_chunk('../code/survey_tbls_appendix.R')
# set R options
ggplot2::theme_set(ggplot2::theme_bw())
options(scipen=2, digits=2)
# set knitr options
knitr::opts_chunk$set(message=FALSE,
warning=FALSE,
echo = FALSE,
cache = TRUE,
fig.path='figures/',
out.extra = "",
floatfoot.envs = c("figure", "table", "longtabu"))
df <- ys_panel %>% zap_labels() %>% filter(as.factor(status) %in% c(2:4), wave == 0) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df$status <- factor(df$status, levels = c(2:4), labels=c("NEET", "Self-Employed", "Employed"))
df$fiveyrs <- factor(df$fiveyrs, levels = c(0:5), labels = c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other"))
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?",
statistic = list(all_categorical() ~ "{p}%")) %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA)
df <- ys_panel %>% zap_labels() %>% filter(as.factor(status) %in% c(2:4), wave == "Baseline") %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?",
statistic = list(all_categorical() ~ "{p*100}%")) %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA)
df <- ys_panel %>% zap_labels() %>% filter(as.factor(status) %in% c(2:4), wave == "Baseline") %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df$status <- factor(df$status, levels = c(2:4), labels=c("NEET", "Self-Employed", "Employed"))
df$fiveyrs <- factor(df$fiveyrs, levels = c(0:5), labels = c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other"))
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?",
statistic = list(all_categorical() ~ "{p*100}%")) %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA)
ys_panel$wave
## Data
ys_panel <- read_sav("data/youth_survey_reshaped.sav", user_na = TRUE)
ys_panel$wave
source("~/polybox/Youth Employment/1a Youth Survey/Markdown/code/prep/survey_cleaning.R", echo=TRUE)
df <- ys_panel %>% zap_labels() %>% filter(as.factor(status) %in% c(2:4), wave == "YS") %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df$status <- factor(df$status, levels = c(2:4), labels=c("NEET", "Self-Employed", "Employed"))
df$fiveyrs <- factor(df$fiveyrs, levels = c(0:5), labels = c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other"))
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?",
statistic = list(all_categorical() ~ "{p*100}%")) %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA)
ys_panel$wave
df <- ys_panel %>% zap_labels() %>% filter(as.factor(status) %in% c(2:4), wave == 0) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
source("~/polybox/Youth Employment/1a Youth Survey/Markdown/code/prep/survey_cleaning.R", echo=TRUE)
df <- ys_panel %>% zap_labels() %>% filter(as.factor(status) %in% c(2:4), wave == 0) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df <- ys_panel %>% zap_labels() %>% filter(as.factor(status) %in% c(2:4), wave == "YS") %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df <- ys_panel %>% zap_labels() %>% filter(as.factor(status) %in% c(2:4) & wave == 0) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df <- ys_panel %>% zap_labels() %>% filter(as.factor(status) %in% c(2:4) & wave == "YS") %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
source("~/polybox/Youth Employment/1a Youth Survey/Markdown/code/prep/survey_cleaning.R", echo=TRUE)
df <- ys_panel %>% zap_labels() %>% filter(as.factor(status) %in% c(2:4) & wave == 0) %>% mutate(fiveyrs = case_when(YS8_36 == 7 | YS8_36 == 9 | YS9_37 == 6 | YS10_27 == 4 | YS10_27 == 7 ~ 5, # other
YS8_36 == 5 | YS8_36 == 6 | YS9_37 == 4 | YS10_27 == 5 | YS10_27 == 6 ~ 4, # in education/training
YS8_36 == 3 | YS9_37 == 1 | YS10_27 == 2 ~ 3, # (still) self-employed
YS8_36 == 2 | YS9_37 == 2 | YS10_27 == 3 ~ 2, # different/new employer
YS8_36 == 1 ~ 1, # same employer
YS10_27 == 1 ~ 0))
df$status <- factor(df$status, levels = c(2:4), labels=c("NEET", "Self-Employed", "Employed"))
df$fiveyrs <- factor(df$fiveyrs, levels = c(0:5), labels = c("Still looking for work", "Same employer", "Different/new employer", "(Still) self-employed", "In education/training", "Other"))
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?",
statistic = list(all_categorical() ~ "{p*100}%")) %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA)
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?",
statistic = list(all_categorical() ~ "{p}%")) %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA)
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?",
statistic = list(all_categorical() ~ "{p}%")) %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA) %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_1 = ifelse(stat_1 == "0%", "-", stat_1),
stat_2 = ifelse(stat_2 == "0%", "-", stat_2),
stat_3 = ifelse(stat_3 == "0%", "-", stat_3)))
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?",
statistic = list(all_categorical() ~ "{p}%")) %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA) %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_1 = ifelse(stat_1 == "0%", "-", stat_1),
stat_2 = ifelse(stat_2 == "0%", "-", stat_2),
stat_3 = ifelse(stat_3 == "0%", "-", stat_3))) %>%
as_kable_extra(caption = "Youth Aspirations",
booktabs = T,
linesep = "",
position = "H") %>%
footnote(general = "Calculated using responses from baseline survey.",
threeparttable = T,
escape = F,
fixed_small_size = T,
general_title = "") %>%
kableExtra::kable_styling(latex_options="scale_down")
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?",
statistic = list(all_categorical() ~ "{p}%")) %>%
modify_header(update = all_stat_cols() ~  "**{level}**\nN={n_} ({round(p*100,0)}%)") %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA) %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_1 = ifelse(stat_1 == "0%", "-", stat_1),
stat_2 = ifelse(stat_2 == "0%", "-", stat_2),
stat_3 = ifelse(stat_3 == "0%", "-", stat_3))) %>%
as_kable_extra(caption = "Youth Aspirations",
booktabs = T,
linesep = "",
position = "H") %>%
footnote(general = "Calculated using responses from baseline survey.",
threeparttable = T,
escape = F,
fixed_small_size = T,
general_title = "") %>%
kableExtra::kable_styling(latex_options="scale_down")
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?",
statistic = list(all_categorical() ~ "{p}%")) %>%
modify_header(update = all_stat_cols() ~  "**{level}**\nN={n} ({round(p*100,0)}%)") %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA) %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_1 = ifelse(stat_1 == "0%", "-", stat_1),
stat_2 = ifelse(stat_2 == "0%", "-", stat_2),
stat_3 = ifelse(stat_3 == "0%", "-", stat_3))) %>%
as_kable_extra(caption = "Youth Aspirations",
booktabs = T,
linesep = "",
position = "H") %>%
footnote(general = "Calculated using responses from baseline survey.",
threeparttable = T,
escape = F,
fixed_small_size = T,
general_title = "") %>%
kableExtra::kable_styling(latex_options="scale_down")
df %>% tbl_summary(by = "status",
include = "fiveyrs",
missing = "no",
label = fiveyrs ~ "Where do you see yourself in five years?",
statistic = list(all_categorical() ~ "{p}%")) %>%
modify_header(update = all_stat_cols() ~  "**{level}**\nN={n}") %>%
modify_header(label = " ") %>%
modify_footnote(update = everything() ~ NA) %>%
modify_table_body(~.x %>%
dplyr::mutate(stat_1 = ifelse(stat_1 == "0%", "-", stat_1),
stat_2 = ifelse(stat_2 == "0%", "-", stat_2),
stat_3 = ifelse(stat_3 == "0%", "-", stat_3))) %>%
as_kable_extra(caption = "Youth Aspirations",
booktabs = T,
linesep = "",
position = "H") %>%
footnote(general = "Calculated using responses from baseline survey.",
threeparttable = T,
escape = F,
fixed_small_size = T,
general_title = "") %>%
kableExtra::kable_styling(latex_options="scale_down")
