t3 <- df %>% select(status_wave_F2U, informal_wave_F3U, sex_wave_F3U) %>% filter(informal_wave_F3U == 1) %>% rename("From" = status_wave_F2U, "to" = informal_wave_F3U, "sex" = sex_wave_F3U)
t4 <- df %>% select(status_wave_F3U, informal_wave_F4U, sex_wave_F4U) %>% filter(informal_wave_F4U == 1) %>% rename("From" = status_wave_F3U, "to" = informal_wave_F4U, "sex" = sex_wave_F4U)
ttot <- rbind(t1, t2, t3, t4)
x <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = "row") %>% adorn_pct_formatting(digits = 2)
y <- tabyl(ttot, From, to, sex, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = "row") %>% adorn_pct_formatting(digits = 2)
informal <- rbind(x, y[[1]], y[[2]]) %>% select(-"From") %>% rename("Informal" = `1`)
# regular
t1 <- df %>% select(status_wave_YS, regular_wave_F1U, sex_wave_F1U) %>% filter(regular_wave_F1U == 1) %>% rename("From" = status_wave_YS, "to" = regular_wave_F1U, "sex" = sex_wave_F1U)
t2 <- df %>% select(status_wave_F1U, regular_wave_F2U, sex_wave_F2U) %>% filter(regular_wave_F2U == 1) %>% rename("From" = status_wave_F1U, "to" = regular_wave_F2U, "sex" = sex_wave_F2U)
t3 <- df %>% select(status_wave_F2U, regular_wave_F3U, sex_wave_F3U) %>% filter(regular_wave_F3U == 1) %>% rename("From" = status_wave_F2U, "to" = regular_wave_F3U, "sex" = sex_wave_F3U)
t4 <- df %>% select(status_wave_F3U, regular_wave_F4U, sex_wave_F4U) %>% filter(regular_wave_F4U == 1) %>% rename("From" = status_wave_F3U, "to" = regular_wave_F4U, "sex" = sex_wave_F4U)
ttot <- rbind(t1, t2, t3, t4)
x <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = "row") %>% adorn_pct_formatting(digits = 2)
y <- tabyl(ttot, From, to, sex, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = "row") %>% adorn_pct_formatting(digits = 2)
regular <- rbind(x, y[[1]], y[[2]]) %>% select(-"From") %>% rename("Regular" = `1`)
# casual
t1 <- df %>% select(status_wave_YS, casual_wave_F1U, sex_wave_F1U) %>% filter(casual_wave_F1U == 1) %>% rename("From" = status_wave_YS, "to" = casual_wave_F1U, "sex" = sex_wave_F1U)
t2 <- df %>% select(status_wave_F1U, casual_wave_F2U, sex_wave_F2U) %>% filter(casual_wave_F2U == 1) %>% rename("From" = status_wave_F1U, "to" = casual_wave_F2U, "sex" = sex_wave_F2U)
t3 <- df %>% select(status_wave_F2U, casual_wave_F3U, sex_wave_F3U) %>% filter(casual_wave_F3U == 1) %>% rename("From" = status_wave_F2U, "to" = casual_wave_F3U, "sex" = sex_wave_F3U)
t4 <- df %>% select(status_wave_F3U, casual_wave_F4U, sex_wave_F4U) %>% filter(casual_wave_F4U == 1) %>% rename("From" = status_wave_F3U, "to" = casual_wave_F4U, "sex" = sex_wave_F4U)
ttot <- rbind(t1, t2, t3, t4)
x <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = "row") %>% adorn_pct_formatting(digits = 2)
y <- tabyl(ttot, From, to, sex, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = "row") %>% adorn_pct_formatting(digits = 2)
casual <- rbind(x, y[[1]], y[[2]]) %>% select(-"From") %>% rename("Casual" = `1`)
# underemp
t1 <- df %>% select(status_wave_YS, underemp_wave_F1U, sex_wave_F1U) %>% filter(underemp_wave_F1U == 1) %>% rename("From" = status_wave_YS, "to" = underemp_wave_F1U, "sex" = sex_wave_F1U)
t2 <- df %>% select(status_wave_F1U, underemp_wave_F2U, sex_wave_F2U) %>% filter(underemp_wave_F2U == 1) %>% rename("From" = status_wave_F1U, "to" = underemp_wave_F2U, "sex" = sex_wave_F2U)
t3 <- df %>% select(status_wave_F2U, underemp_wave_F3U, sex_wave_F3U) %>% filter(underemp_wave_F3U == 1) %>% rename("From" = status_wave_F2U, "to" = underemp_wave_F3U, "sex" = sex_wave_F3U)
t4 <- df %>% select(status_wave_F3U, underemp_wave_F4U, sex_wave_F4U) %>% filter(underemp_wave_F4U == 1) %>% rename("From" = status_wave_F3U, "to" = underemp_wave_F4U, "sex" = sex_wave_F4U)
ttot <- rbind(t1, t2, t3, t4)
x <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = "row") %>% adorn_pct_formatting(digits = 2)
y <- tabyl(ttot, From, to, sex, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = "row") %>% adorn_pct_formatting(digits = 2)
underemp <- rbind(x, y[[1]], y[[2]]) %>% select(-"From") %>% rename("Under-\nemployed" = `1`)
# employer
t1 <- df %>% select(status_wave_YS, employer_wave_F1U, sex_wave_F1U) %>% filter(employer_wave_F1U == 1) %>% rename("From" = status_wave_YS, "to" = employer_wave_F1U, "sex" = sex_wave_F1U)
t2 <- df %>% select(status_wave_F1U, employer_wave_F2U, sex_wave_F2U) %>% filter(employer_wave_F2U == 1) %>% rename("From" = status_wave_F1U, "to" = employer_wave_F2U, "sex" = sex_wave_F2U)
t3 <- df %>% select(status_wave_F2U, employer_wave_F3U, sex_wave_F3U) %>% filter(employer_wave_F3U == 1) %>% rename("From" = status_wave_F2U, "to" = employer_wave_F3U, "sex" = sex_wave_F3U)
t4 <- df %>% select(status_wave_F3U, employer_wave_F4U, sex_wave_F4U) %>% filter(employer_wave_F4U == 1) %>% rename("From" = status_wave_F3U, "to" = employer_wave_F4U, "sex" = sex_wave_F4U)
ttot <- rbind(t1, t2, t3, t4)
x <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = "row") %>% adorn_pct_formatting(digits = 2)
y <- tabyl(ttot, From, to, sex, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = "row") %>% adorn_pct_formatting(digits = 2)
employer <- rbind(x, y[[1]], y[[2]]) %>% select(-"From") %>% rename("Employer" = `1`)
# independent
t1 <- df %>% select(status_wave_YS, independent_wave_F1U, sex_wave_F1U) %>% filter(independent_wave_F1U == 1) %>% rename("From" = status_wave_YS, "to" = independent_wave_F1U, "sex" = sex_wave_F1U)
t2 <- df %>% select(status_wave_F1U, independent_wave_F2U, sex_wave_F2U) %>% filter(independent_wave_F2U == 1) %>% rename("From" = status_wave_F1U, "to" = independent_wave_F2U, "sex" = sex_wave_F2U)
t3 <- df %>% select(status_wave_F2U, independent_wave_F3U, sex_wave_F3U) %>% filter(independent_wave_F3U == 1) %>% rename("From" = status_wave_F2U, "to" = independent_wave_F3U, "sex" = sex_wave_F3U)
t4 <- df %>% select(status_wave_F3U, independent_wave_F4U, sex_wave_F4U) %>% filter(independent_wave_F4U == 1) %>% rename("From" = status_wave_F3U, "to" = independent_wave_F4U, "sex" = sex_wave_F4U)
ttot <- rbind(t1, t2, t3, t4)
x <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = "row") %>% adorn_pct_formatting(digits = 2)
y <- tabyl(ttot, From, to, sex, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = "row") %>% adorn_pct_formatting(digits = 2)
independent <- rbind(x, y[[1]], y[[2]]) %>% select(-"From") %>% rename("Indep." = `1`)
tab1 <- cbind(formal, informal, regular, casual, underemp, employer, independent)
tab1 <- cbind(formal, informal, regular, casual, underemp, employer, independent)
tab1 <- tab1[c(1,7,13,2,8,14,3,9,15,4,10,16,5,11,17),]
tab1[7,1] <- "Self-Emp."
flextable(tab1) %>%
theme_booktabs() %>%
autofit(part = "all") %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Transition Propensities into Different Types of Work") %>%
fontsize(size = 9, part = 'all') %>%
width(width = .7) %>%
width(j = 8, width = .2) %>%
bold(i = c(1,4,7,10,13), bold = TRUE)
flextable(tab1) %>%
theme_booktabs() %>%
autofit(part = "all") %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
add_header_row(values = c('','To'),
colwidths = c(4,4)) %>%
set_caption("Transition Propensities into Different Types of Work") %>%
fontsize(size = 9, part = 'all') %>%
width(width = .7) %>%
width(j = 8, width = .4) %>%
bold(i = c(1,4,7,10,13), bold = TRUE)
flextable(tab1) %>%
theme_booktabs() %>%
autofit(part = "all") %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
add_header_row(values = c('','To'),
colwidths = c(4,4), top = F) %>%
set_caption("Transition Propensities into Different Types of Work") %>%
fontsize(size = 9, part = 'all') %>%
width(width = .7) %>%
width(j = 8, width = .4) %>%
bold(i = c(1,4,7,10,13), bold = TRUE)
flextable(tab1) %>%
theme_booktabs() %>%
autofit(part = "all") %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
add_header_row(values = c('','To'),
colwidths = c(4,4)) %>%
set_caption("Transition Propensities into Different Types of Work") %>%
fontsize(size = 9, part = 'all') %>%
width(width = .7) %>%
width(j = 8, width = .4) %>%
bold(i = c(1,4,7,10,13), bold = TRUE)
flextable(tab1) %>%
theme_booktabs() %>%
autofit(part = "all") %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
add_header_row(values = c('','To'),
colwidths = c(4,4)) %>%
set_caption("Transition Propensities into Different Types of Work") %>%
fontsize(size = 9, part = 'all') %>%
width(width = .7) %>%
width(j = 8, width = .4) %>%
bold(i = c(1,4,7,10,13), bold = TRUE) %>%
border_remove()
flextable(tab1) %>%
theme_booktabs() %>%
autofit(part = "all") %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
add_header_row(values = c('','To'),
colwidths = c(4,4)) %>%
set_caption("Transition Propensities into Different Types of Work") %>%
fontsize(size = 9, part = 'all') %>%
width(width = .7) %>%
width(j = 8, width = .4) %>%
bold(i = c(1,4,7,10,13), bold = TRUE) %>%
border_remove() %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
flextable(tab1) %>%
theme_booktabs() %>%
autofit(part = "all") %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
add_header_row(values = c('','To'),
colwidths = c(4,4)) %>%
set_caption("Transition Propensities into Different Types of Work") %>%
fontsize(size = 9, part = 'all') %>%
width(width = .7) %>%
width(j = 8, width = .4) %>%
bold(i = c(1,4,7,10,13), bold = TRUE) %>%
border_remove() %>%
hline_top(border = fp_border_default(width = 0), part = "header")
flextable(tab1) %>%
theme_booktabs() %>%
autofit(part = "all") %>%
add_header_row(values = c('','To'),
colwidths = c(4,4)) %>%
set_caption("Transition Propensities into Different Types of Work") %>%
fontsize(size = 9, part = 'all') %>%
width(width = .7) %>%
width(j = 8, width = .4) %>%
bold(i = c(1,4,7,10,13), bold = TRUE) %>%
border_remove() %>%
hline_top(border = fp_border_default(width = 0), part = "header")
flextable(tab1) %>%
theme_booktabs() %>%
autofit(part = "all")
flextable(tab1) %>%
theme_booktabs() %>%
autofit(part = "all") %>%
add_header_row(values = c('','To'),
colwidths = c(4,4)) %>%
set_caption("Transition Propensities into Different Types of Work") %>%
fontsize(size = 9, part = 'all') %>%
width(width = .7) %>%
width(j = 8, width = .4) %>%
bold(i = c(1,4,7,10,13), bold = TRUE)
flextable(tab1) %>%
theme_booktabs() %>%
autofit(part = "all") %>%
add_header_row(values = c('','To'),
colwidths = c(4,4)) %>%
set_caption("Transition Propensities into Different Types of Work") %>%
fontsize(size = 9, part = 'all') %>%
width(width = .7) %>%
width(j = 8, width = .4) %>%
bold(i = c(1,4,7,10,13), bold = TRUE) %>%
border_remove()
flextable(tab1) %>%
theme_booktabs() %>%
autofit(part = "all") %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
add_header_row(values = c('','To'),
colwidths = c(4,4)) %>%
set_caption("Transition Propensities into Different Types of Work") %>%
fontsize(size = 9, part = 'all') %>%
width(width = .7) %>%
width(j = 8, width = .4) %>%
bold(i = c(1,4,7,10,13), bold = TRUE)
t1 <- ys_panel %>% select(status_wave_YS, status_wave_F1U) %>% filter(status_wave_F1U == 1) %>% rename("From" = status_wave_YS, "to" = status_wave_F1U)
df <- ys_panel_labels %>% select(IDYouth, wave, status) %>% pivot_wider(id_cols = IDYouth, names_from = wave, values_from = c(status), names_prefix = "wave_")
View(df)
t1 <- ys_panel %>% select(status_wave_YS, status_wave_F1U) %>% filter(status_wave_F1U == 1) %>% rename("From" = status_wave_YS, "to" = status_wave_F1U)
t2 <- df %>% select(status_wave_F1U, status_wave_F2U, sex_wave_F2U) %>% filter(status_wave_F2U == 1) %>% rename("From" = status_wave_F1U, "to" = status_wave_F2U, "sex" = sex_wave_F2U)
t1 <- ys_panel %>% select(status_wave_YS) %>% filter(status_wave_F1U == 1) %>% rename("From" = status_wave_YS, "to" = status_wave_F1U)
t2 <- df %>% select(status_wave_F1U, status_wave_F2U) %>% filter(status_wave_F2U == 1) %>% rename("From" = status_wave_F1U, "to" = status_wave_F2U)
t3 <- df %>% select(status_wave_F2U, status_wave_F3U) %>% filter(status_wave_F3U == 1) %>% rename("From" = status_wave_F2U, "to" = status_wave_F3U)
t1 <- ys_panel %>% select(status_YS) %>% filter(status_F1U == 1) %>% rename("From" = status_YS, "to" = status_F1U)
t2 <- df %>% select(status_F1U, status_F2U) %>% filter(status_F2U == 1) %>% rename("From" = status_F1U, "to" = status_F2U)
t3 <- df %>% select(status_F2U, status_F3U) %>% filter(status_F3U == 1) %>% rename("From" = status_F2U, "to" = status_F3U)
View(df)
t1 <- df %>% select(status_YS) %>% filter(status_F1U == 1) %>% rename("From" = status_YS, "to" = status_F1U)
t2 <- df %>% select(status_F1U, status_F2U) %>% filter(status_F2U == 1) %>% rename("From" = status_F1U, "to" = status_F2U)
View(df)
t1 <- df %>% select(wave_YS, wave_F1U) %>% filter(wave_F1U == 1) %>% rename("From" = wave_YS, "to" = wave_F1U)
View(df)
t1 <- df %>% select(wave_YS, wave_F1U) %>% rename("From" = wave_YS, "to" = wave_F1U)
t2 <- df %>% select(wave_F1U, wave_F2U) %>% rename("From" = wave_F1U, "to" = wave_F2U)
t3 <- df %>% select(wave_F2U, wave_F3U) %>% rename("From" = wave_F2U, "to" = wave_F3U)
t4 <- df %>% select(wave_F3U, wave_F4U) %>% rename("From" = wave_F3U, "to" = wave_F4U)
ttot <- rbind(t1, t2, t3, t4)
x <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages(c("col", "row") %>% adorn_totals(where = c("col", "row")) %>% adorn_pct_formatting(digits = 2)
flextable(x)
x <- tabyl(df, to, From, show_na = FALSE) %>% adorn_percentages("row") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
t1 <- df %>% select(wave_YS, wave_F1U) %>% rename("From" = wave_YS, "to" = wave_F1U)
t2 <- df %>% select(wave_F1U, wave_F2U) %>% rename("From" = wave_F1U, "to" = wave_F2U)
t3 <- df %>% select(wave_F2U, wave_F3U) %>% rename("From" = wave_F2U, "to" = wave_F3U)
t4 <- df %>% select(wave_F3U, wave_F4U) %>% rename("From" = wave_F3U, "to" = wave_F4U)
ttot <- rbind(t1, t2, t3, t4)
x <- tabyl(ttot, to, From, show_na = FALSE) %>% adorn_percentages("row") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
y <- tabyl(ttot, to, From, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
x[-1] <- paste0(as.matrix(x[-1]), "\n(", as.matrix(y[-1]), ")")
flextable(x) %>% add_header_row(values = c('','Follow-up 2'),
colwidths = c(6,1)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Activity transition matrix: Follow-up wave 1 and follow-up wave 2") %>%
add_footer_lines("Row % (column %)") %>%
fontsize(size = 9, part = 'all')
flextable(x) %>% add_header_row(values = c('','From'),
colwidths = c(6,1)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Activity transition matrix: Follow-up wave 1 and follow-up wave 2") %>%
add_footer_lines("Row % (column %)") %>%
fontsize(size = 9, part = 'all')
x <- tabyl(ttot, to, From, show_na = FALSE) %>% adorn_percentages("row") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
y <- tabyl(ttot, to, From, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
x[-1] <- paste0(as.matrix(x[-1]), "\n(", as.matrix(y[-1]), ")")
names(x)[names(x) == 'to'] <- 'To'
x[6,7] <- ''
flextable(x) %>% add_header_row(values = c('','From'),
colwidths = c(6,1)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Activity transition matrix: Follow-up wave 1 and follow-up wave 2") %>%
add_footer_lines("Row % (column %)") %>%
fontsize(size = 9, part = 'all')
flextable(x) %>% add_header_row(values = c('','From'),
colwidths = c(6,1)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Activity transition matrix: pooled") %>%
add_footer_lines("Row % (column %)") %>%
fontsize(size = 9, part = 'all')
flextable(x) %>% add_header_row(values = c('','From'),
colwidths = c(6,1)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Activity transition matrix: pooled") %>%
add_footer_lines("Row %\n(column %)") %>%
fontsize(size = 9, part = 'all')
flextable(x) %>% add_header_row(values = c('','From'),
colwidths = c(6,1)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Activity transition matrix: pooled") %>%
add_footer_lines("Row %\n(column %)") %>%
fontsize(size = 9, part = 'all')
flextable(x) %>% add_header_row(values = c('','From'),
colwidths = c(6,1)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Activity transition matrix: pooled") %>%
add_footer_lines("Row %\n(Column %)") %>%
fontsize(size = 9, part = 'all')
x <- tabyl(ttot, to, From, show_na = FALSE) %>% adorn_percentages("row") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
x
x <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("row") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
y <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
x[-1] <- paste0(as.matrix(x[-1]), "\n(", as.matrix(y[-1]), ")")
names(x)[names(x) == 'to'] <- 'To'
x[6,7] <- ''
flextable(x) %>% add_header_row(values = c('','From'),
colwidths = c(6,1)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Activity transition matrix: pooled") %>%
add_footer_lines("Row %\n(Column %)") %>%
fontsize(size = 9, part = 'all')
flextable(x)
flextable(x) %>% add_header_row(values = c('','From'),
colwidths = c(6,1)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Activity transition matrix: pooled") %>%
add_footer_lines("Row %\n(Column %)") %>%
fontsize(size = 9, part = 'all')
x <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("row") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
y <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
x[-1] <- paste0(as.matrix(x[-1]), "\n(", as.matrix(y[-1]), ")")
names(x)[names(x) == 'From'] <- 'From'
x[6,7] <- ''
flextable(x) %>% add_header_row(values = c('','To'),
colwidths = c(6,1)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Activity transition matrix: pooled") %>%
add_footer_lines("Row %\n(Column %)") %>%
fontsize(size = 9, part = 'all')
flextable(x) %>% add_header_row(values = c('','To'),
colwidths = c(4,4)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Activity transition matrix: pooled") %>%
add_footer_lines("Row %\n(Column %)") %>%
fontsize(size = 9, part = 'all')
flextable(x) %>% add_header_row(values = c('','To'),
colwidths = c(4,3)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Activity transition matrix: pooled") %>%
add_footer_lines("Row %\n(Column %)") %>%
fontsize(size = 9, part = 'all')
flextable(x) %>% add_header_row(values = c('','To'),
colwidths = c(3,4)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Activity transition matrix: pooled") %>%
add_footer_lines("Row %\n(Column %)") %>%
fontsize(size = 9, part = 'all')
unlink("markdown/youth_survey_cache", recursive = TRUE)
# calculate number of years spent in each activity in past seven years
ys_panel$yrs_school <- 0
ys_panel$yrs_app <- 0
ys_panel$yrs_self <- 0
ys_panel$yrs_emp <- 0
ys_panel$yrs_neet <- 0
for (k in 1:2439){
for (i in 1:7){
y <- dflist[i]
if(ys_panel[[y]][[k]] %in% c(1:3)) {
ys_panel[["yrs_school"]][[k]] <- ys_panel[["yrs_school"]][[k]] + 1
}
if(ys_panel[[y]][[k]] %in% c(4:5)) {
ys_panel[["yrs_app"]][[k]] <- ys_panel[["yrs_app"]][[k]] + 1
}
if(!is.na(ys_panel[[y]][[k]]) && ys_panel[[y]][[k]] == 6) {
ys_panel[["yrs_emp"]][[k]] <- ys_panel[["yrs_emp"]][[k]] + 1
}
if(!is.na(ys_panel[[y]][[k]]) && ys_panel[[y]][[k]] == 7) {
ys_panel[["yrs_self"]][[k]] <- ys_panel[["yrs_self"]][[k]] + 1
}
if(ys_panel[[y]][[k]] %in% c(0,8)) {
ys_panel[["yrs_neet"]][[k]] <- ys_panel[["yrs_neet"]][[k]] + 1
}
}
}
ys_panel$act13
df <- ys_panel_labels %>% select(IDYouth, wave, contains("act")) %>% pivot_wider(id_cols = IDYouth, names_from = wave, values_from = c(status), names_prefix = "wave_")
df <- ys_panel_labels %>% select(IDYouth, wave, contains("act")) %>% pivot_wider(id_cols = IDYouth, names_from = wave, values_from = c(act1), names_prefix = "wave_")
df <- ys_panel_labels %>% select(IDYouth, wave, contains("act")) %>% pivot_wider(id_cols = IDYouth, names_from = wave, values_from = c(act19), names_prefix = "wave_")
View(df)
df <- ys_panel_labels %>% select(IDYouth, wave, contains("act")) %>% pivot_wider(id_cols = IDYouth, names_from = wave, values_from = c(contains("act")), names_prefix = "wave_")
df <- ys_panel_labels %>% select(IDYouth, wave, contains("act")) %>% pivot_wider(id_cols = IDYouth, names_from = wave, values_from = c(act13, act14, act15, act16, act17, act18, act19), names_prefix = "wave_")
df <- ys_panel_labels %>% select(IDYouth, contains("act")) %>% pivot_wider(id_cols = IDYouth, names_from = wave, values_from = c(act13, act14, act15, act16, act17, act18, act19), names_prefix = "wave_")
df <- ys_panel_labels %>% select(IDYouth, contains("act"))
View(df)
t1 <- ys_panel %>% select(act13, act14) %>% rename("From" = act13, "to" = act14)
t2 <- ys_panel %>% select(act14, act15) %>% rename("From" = act14, "to" = act15)
t3 <- ys_panel %>% select(act15, act16) %>% rename("From" = act15, "to" = act16)
t4 <- ys_panel %>% select(act16, act17) %>% rename("From" = act16, "to" = act17)
t5 <- ys_panel %>% select(act17, act18) %>% rename("From" = act17, "to" = act18)
t6 <- ys_panel %>% select(act18, act19) %>% rename("From" = act18, "to" = act19)
ttot <- rbind(t1, t2, t3, t4, t5, t6)
View(ttot)
x <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("row") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
y <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
x[-1] <- paste0(as.matrix(x[-1]), "\n(", as.matrix(y[-1]), ")")
names(x)[names(x) == 'From'] <- 'From'
x[6,7] <- ''
flextable(x) %>% add_header_row(values = c('','To'),
colwidths = c(3,4)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Activity transition matrix: Panel data, pooled, 2019-2021") %>%
add_footer_lines("Row %\n(Column %)") %>%
fontsize(size = 9, part = 'all')
ttot <- rbind(t1, t2, t3, t4, t5, t6) %>% filter(to %in% c(0:7))
View(ttot)
ttot <- rbind(t1, t2, t3, t4, t5, t6) %>% filter(to %in% c(0:7)) %>% filter(From %in% c(0:7))
View(ttot)
x <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("row") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
y <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
x[-1] <- paste0(as.matrix(x[-1]), "\n(", as.matrix(y[-1]), ")")
names(x)[names(x) == 'From'] <- 'From'
x[6,7] <- ''
flextable(x) %>% add_header_row(values = c('','To'),
colwidths = c(3,4)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Activity transition matrix: Panel data, pooled, 2019-2021") %>%
add_footer_lines("Row %\n(Column %)") %>%
fontsize(size = 9, part = 'all')
flextable(x) %>% add_header_row(values = c('','To'),
colwidths = c(4,4)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Activity transition matrix: Panel data, pooled, 2019-2021") %>%
add_footer_lines("Row %\n(Column %)") %>%
fontsize(size = 9, part = 'all')
flextable(x)
ttot <- rbind(t1, t2, t3, t4, t5, t6) %>%
mutate(to2 = case_when(to == 1 | to == 2 | to == 3)
carb > 2  ~ "high"))
ttot <- rbind(t1, t2, t3, t4, t5, t6) %>%
mutate(to2 = case_when(to == 1 | to == 2 | to == 3))
ttot <- rbind(t1, t2, t3, t4, t5, t6) %>%
mutate(to2 = case_when(to == 1 | to == 2 | to == 3 ~ "School",
to == 0 | to == 8 | to == 99 ~ "NEET")
)
View(ttot)
ttot <- rbind(t1, t2, t3, t4, t5, t6) %>%
mutate(to2 = case_when(to == 1 | to == 2 | to == 3 ~ "School",
to == 0 | to == 8 | to == 99 ~ "NEET",
to == 7 ~ "Self-Employed",
to == 4 | to == 5 ~ "Apprentice",
to == 6 ~ "Wage Employed")) %>%
filter(!is.na())
ttot <- rbind(t1, t2, t3, t4, t5, t6) %>%
mutate(to = case_when(to == 1 | to == 2 | to == 3 ~ "School",
to == 0 | to == 8 | to == 99 ~ "NEET",
to == 7 ~ "Self-Employed",
to == 4 | to == 5 ~ "Apprentice",
to == 6 ~ "Wage Employed")) %>%
filter(!is.na())
ttot <- rbind(t1, t2, t3, t4, t5, t6) %>%
mutate(to = case_when(to == 1 | to == 2 | to == 3 ~ "School",
to == 0 | to == 8 | to == 99 ~ "NEET",
to == 7 ~ "Self-Employed",
to == 4 | to == 5 ~ "Apprentice",
to == 6 ~ "Wage Employed"))
View(ttot)
ttot <- rbind(t1, t2, t3, t4, t5, t6) %>%
mutate(to = case_when(to == 1 | to == 2 | to == 3 ~ "School",
to == 0 | to == 8 | to == 99 ~ "NEET",
to == 7 ~ "Self-Employed",
to == 4 | to == 5 ~ "Apprentice",
to == 6 ~ "Wage Employed"),
From = case_when(to == 1 | to == 2 | to == 3 ~ "School",
to == 0 | to == 8 | to == 99 ~ "NEET",
to == 7 ~ "Self-Employed",
to == 4 | to == 5 ~ "Apprentice",
to == 6 ~ "Wage Employed")))
ttot <- rbind(t1, t2, t3, t4, t5, t6) %>%
mutate(to = case_when(to == 1 | to == 2 | to == 3 ~ "School",
to == 0 | to == 8 | to == 99 ~ "NEET",
to == 7 ~ "Self-Employed",
to == 4 | to == 5 ~ "Apprentice",
to == 6 ~ "Wage Employed"),
From = case_when(to == 1 | to == 2 | to == 3 ~ "School",
to == 0 | to == 8 | to == 99 ~ "NEET",
to == 7 ~ "Self-Employed",
to == 4 | to == 5 ~ "Apprentice",
to == 6 ~ "Wage Employed"))
View(ttot)
ttot <- rbind(t1, t2, t3, t4, t5, t6) %>%
mutate(to = case_when(to == 1 | to == 2 | to == 3 ~ "School",
to == 0 | to == 8 | to == 99 ~ "NEET",
to == 7 ~ "Self-Employed",
to == 4 | to == 5 ~ "Apprentice",
to == 6 ~ "Wage Employed"),
From = case_when(From == 1 | From == 2 | From == 3 ~ "School",
From == 0 | From == 8 | From == 99 ~ "NEET",
From == 7 ~ "Self-Employed",
From == 4 | From == 5 ~ "Apprentice",
From == 6 ~ "Wage Employed"))
View(ttot)
x <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("row") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
y <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
x[-1] <- paste0(as.matrix(x[-1]), "\n(", as.matrix(y[-1]), ")")
names(x)[names(x) == 'From'] <- 'From'
x[6,7] <- ''
flextable(x) %>% add_header_row(values = c('','To'),
colwidths = c(3,4)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Activity transition matrix: Panel data, pooled, 2019-2021") %>%
add_footer_lines("Row %\n(Column %)") %>%
fontsize(size = 9, part = 'all')
flextable(x) %>% add_header_row(values = c('','To'),
colwidths = c(3,4)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Event history transition matrix, 2013-2019") %>%
add_footer_lines("Row %\n(Column %)") %>%
fontsize(size = 9, part = 'all')
ttot <- rbind(t1, t2, t3, t4, t5, t6) %>%
mutate(to = case_when(to == 1 | to == 2 | to == 3 ~ "In School",
to == 0 | to == 8 | to == 99 ~ "NEET",
to == 7 ~ "Self-Employed",
to == 4 | to == 5 ~ "Apprentice",
to == 6 ~ "Employed"),
From = case_when(From == 1 | From == 2 | From == 3 ~ "In School",
From == 0 | From == 8 | From == 99 ~ "NEET",
From == 7 ~ "Self-Employed",
From == 4 | From == 5 ~ "Apprentice",
From == 6 ~ "Employed"))
ttot$From <- factor(From, levels = c("In School", "NEET", "Self-Employed", "Employed", "Apprentice"))
ttot$From <- factor(ttot$From, levels = c("In School", "NEET", "Self-Employed", "Employed", "Apprentice"))
ttot$To <- factor(ttot$To, levels = c("In School", "NEET", "Self-Employed", "Employed", "Apprentice"))
x <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("row") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
y <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
x <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("row") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
y <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
x[-1] <- paste0(as.matrix(x[-1]), "\n(", as.matrix(y[-1]), ")")
names(x)[names(x) == 'From'] <- 'From'
x[6,7] <- ''
flextable(x) %>% add_header_row(values = c('','To'),
colwidths = c(3,4)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Event history transition matrix, 2013-2019") %>%
add_footer_lines("Row %\n(Column %)") %>%
fontsize(size = 9, part = 'all')
ttot$to <- factor(ttot$to, levels = c("In School", "NEET", "Self-Employed", "Employed", "Apprentice"))
x <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("row") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
y <- tabyl(ttot, From, to, show_na = FALSE) %>% adorn_percentages("col") %>% adorn_totals(where = c("row", "col")) %>% adorn_pct_formatting(digits = 2)
x[-1] <- paste0(as.matrix(x[-1]), "\n(", as.matrix(y[-1]), ")")
names(x)[names(x) == 'From'] <- 'From'
x[6,7] <- ''
flextable(x) %>% add_header_row(values = c('','To'),
colwidths = c(3,4)) %>%
hline_top(border = fp_border_default(width = 0), part = "header") %>%
set_caption("Event history transition matrix, 2013-2019") %>%
add_footer_lines("Row %\n(Column %)") %>%
fontsize(size = 9, part = 'all')
unlink("markdown/youth_survey_cache", recursive = TRUE)
